{"version":3,"file":"index.js","sources":["pages/student/index.vue","../../../../../TOOL/TOOL/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3R1ZGVudC9pbmRleC52dWU"],"sourcesContent":["<!-- 文件路径: pages/student/index.vue -->\n<!-- [最终修复] 修复待办红点和智能跳转 -->\n<template>\n\t<view class=\"container\">\n\t\t<view class=\"header\">\n\t\t\t<image class=\"avatar\" :src=\"userStore.userInfo.avatar\" mode=\"aspectFill\"></image>\n\t\t\t<text class=\"nickname\">{{ userStore.userInfo.nickname }}</text>\n\t\t\t<uni-tag text=\"学生\" type=\"primary\" :inverted=\"true\" />\n\t\t</view>\n\t\t<uni-list>\n\t\t\t<uni-list-item title=\"修改资料\" showArrow clickable @click=\"goProfile\"></uni-list-item>\n\t\t\t<uni-list-item title=\"我的班级\" showArrow clickable @click=\"goMyClasses\"></uni-list-item>\n\t\t\t<uni-list-item title=\"加入班级\" showArrow clickable @click=\"goJoinClass\"></uni-list-item>\n\t\t\t<uni-list-item title=\"提交作业\" showArrow clickable @click=\"goSubmitPage\">\n\t\t\t\t<template v-slot:footer>\n\t\t\t\t\t<uni-badge v-if=\"pendingHomeworkCount > 0\" :text=\"pendingHomeworkCount\" type=\"error\" size=\"small\"></uni-badge>\n\t\t\t\t</template>\n\t\t\t</uni-list-item>\n\t\t\t<uni-list-item title=\"我的作业\" showArrow clickable @click=\"goMyHomeworkPage\"></uni-list-item>\n\t\t</uni-list>\n\t\t<button class=\"logout-btn\" @click=\"logout\">退出登录</button>\n\t</view>\n</template>\n<script setup>\nimport { ref } from 'vue';\nimport { onShow } from '@dcloudio/uni-app';\nimport { useUserStore } from '../../store/user.js';\nimport { getMyHomeworksApi } from '../../api/student.js';\nconst userStore = useUserStore();\nconst pendingHomeworks = ref([]);\nconst pendingHomeworkCount = ref(0);\nonShow(() => { checkPendingHomeworks(); });\nasync function checkPendingHomeworks() {\n\ttry {\n\t\tconst res = await getMyHomeworksApi({ status: 'pending' });\n\t\t// [关键修复] 从返回的对象中正确地解构和赋值\n\t\tif (res && Array.isArray(res.homeworks)) {\n\t\t\tpendingHomeworks.value = res.homeworks;\n\t\t\tpendingHomeworkCount.value = res.homeworks.length;\n\t\t} else {\n\t\t\tpendingHomeworks.value = [];\n\t\t\tpendingHomeworkCount.value = 0;\n\t\t}\n\t} catch (e) {\n\t\tconsole.error(\"检查待办作业失败:\", e);\n\t\tpendingHomeworkCount.value = 0;\n\t}\n}\nfunction goSubmitPage() {\n\tconst count = pendingHomeworkCount.value;\n\tif (count === 0) {\n\t\tuni.showToast({ title: '太棒了，暂时没有待提交的作业！', icon: 'none' });\n\t} else if (count === 1) {\n\t\tconst homeworkId = pendingHomeworks.value[0]._id;\n\t\tuni.navigateTo({ url: `/pages/student/submit-homework?id=${homeworkId}` });\n\t} else {\n\t\tuni.navigateTo({ url: '/pages/student/my-homework?status=pending' });\n\t}\n}\nfunction goProfile() { uni.navigateTo({ url: '/pages/common/user-profile/index' }); }\nfunction goMyClasses() { uni.navigateTo({ url: '/pages/student/my-classes' }); }\nfunction goJoinClass() { uni.navigateTo({ url: '/pages/student/join-class' }); }\nfunction goMyHomeworkPage() { uni.navigateTo({ url: '/pages/student/my-homework' }); }\nfunction logout() { userStore.logout(); uni.reLaunch({ url: '/pages/login' }); }\n</script>\n<style scoped>\n.container { padding: 15px; } .header { display: flex; flex-direction: column; align-items: center; padding: 20px 0; } .avatar { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; } .nickname { font-size: 18px; font-weight: bold; margin-bottom: 10px; } .logout-btn { margin-top: 30px; background-color: #f33; color: white; }\n</style>","import MiniProgramPage from 'D:/share_dir/product_env/git_repo/HomeworkReviewer/HomeworkReviewer/pages/student/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","onShow","getMyHomeworksApi","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;AA4BA,UAAM,YAAYA,WAAY,aAAA;AAC9B,UAAM,mBAAmBC,cAAAA,IAAI,CAAA,CAAE;AAC/B,UAAM,uBAAuBA,cAAAA,IAAI,CAAC;AAClCC,kBAAM,OAAC,MAAM;AAAE;IAAwB,CAAE;AACzC,mBAAe,wBAAwB;AACtC,UAAI;AACH,cAAM,MAAM,MAAMC,YAAiB,kBAAC,EAAE,QAAQ,UAAW,CAAA;AAEzD,YAAI,OAAO,MAAM,QAAQ,IAAI,SAAS,GAAG;AACxC,2BAAiB,QAAQ,IAAI;AAC7B,+BAAqB,QAAQ,IAAI,UAAU;AAAA,QAC9C,OAAS;AACN,2BAAiB,QAAQ;AACzB,+BAAqB,QAAQ;AAAA,QAC7B;AAAA,MACD,SAAQ,GAAG;AACXC,sBAAc,MAAA,MAAA,SAAA,iCAAA,aAAa,CAAC;AAC5B,6BAAqB,QAAQ;AAAA,MAC7B;AAAA,IACF;AACA,aAAS,eAAe;AACvB,YAAM,QAAQ,qBAAqB;AACnC,UAAI,UAAU,GAAG;AAChBA,sBAAG,MAAC,UAAU,EAAE,OAAO,mBAAmB,MAAM,OAAM,CAAE;AAAA,MAC1D,WAAY,UAAU,GAAG;AACvB,cAAM,aAAa,iBAAiB,MAAM,CAAC,EAAE;AAC7CA,sBAAG,MAAC,WAAW,EAAE,KAAK,qCAAqC,UAAU,GAAE,CAAE;AAAA,MAC3E,OAAQ;AACNA,sBAAAA,MAAI,WAAW,EAAE,KAAK,4CAA6C,CAAA;AAAA,MACnE;AAAA,IACF;AACA,aAAS,YAAY;AAAEA,oBAAAA,MAAI,WAAW,EAAE,KAAK,mCAAoC,CAAA;AAAA,IAAI;AACrF,aAAS,cAAc;AAAEA,oBAAAA,MAAI,WAAW,EAAE,KAAK,4BAA6B,CAAA;AAAA,IAAI;AAChF,aAAS,cAAc;AAAEA,oBAAAA,MAAI,WAAW,EAAE,KAAK,4BAA6B,CAAA;AAAA,IAAI;AAChF,aAAS,mBAAmB;AAAEA,oBAAAA,MAAI,WAAW,EAAE,KAAK,6BAA8B,CAAA;AAAA,IAAI;AACtF,aAAS,SAAS;AAAE,gBAAU,OAAM;AAAIA,oBAAAA,MAAI,SAAS,EAAE,KAAK,eAAgB,CAAA;AAAA,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9DhF,GAAG,WAAW,eAAe;"}